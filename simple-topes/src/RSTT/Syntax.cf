comment "--" ;
comment "{-" "-}" ;

layout toplevel ;
layout "with", "where", "prove" ;

token Label ((upper | ["â‰¤â‰¥ğŸ˜ğŸ™ğŸšğŸ›ğŸœğŸğŸğŸŸğŸ ğŸ¡ğŸ¬ğŸ­ğŸ®ğŸ¯ğŸ°ğŸ±ğŸ²ğŸ³ğŸ´ğŸµ"]) (letter | digit | ["_â‰¤â‰¥ğŸ˜ğŸ™ğŸšğŸ›ğŸœğŸğŸğŸŸğŸ ğŸ¡ğŸ¬ğŸ­ğŸ®ğŸ¯ğŸ°ğŸ±ğŸ²ğŸ³ğŸ´ğŸµ"])*) ;
token Var ((lower | ["Î±Î²Î³Î´ÎµÎ¶Î·Î¸Î¹ÎºÎ»Î¼Î½Î¾Î¿Ï€ÏÏ‚ÏƒÏ„Ï…Ï†Ï‡ÏˆÏ‰Î‘Î’Î“Î”Î•Î–Î—Î˜Î™ÎšÎ›ÎœÎÎÎŸÎ Î¡Î£Î¤Î¥Î¦Î§Î¨Î©âˆ‚"]) (letter | digit | ["_Î±Î²Î³Î´ÎµÎ¶Î·Î¸Î¹ÎºÎ»Î¼Î½Î¾Î¿Ï€ÏÏ‚ÏƒÏ„Ï…Ï†Ï‡ÏˆÏ‰Î‘Î’Î“Î”Î•Î–Î—Î˜Î™ÎšÎ›ÎœÎÎÎŸÎ Î¡Î£Î¤Î¥Î¦Î§Î¨Î©âˆ‚â‚€â‚â‚‚â‚ƒâ‚„â‚…â‚†â‚‡â‚ˆâ‚‰â°Â¹Â²Â³â´âµâ¶â·â¸â¹"])*) ;
token Line (["-â€”"] ["-â€”"] ["-â€”"] (["-â€”"])*) ;

Program.  Program ::= [Decl] ;

DeclCube.         Decl ::= "cube" Label "with" "{" [PointConDecl] "}" ;
DeclTopePrefix.   Decl ::= "tope" Label "(" [Cube] ")" "with" "{" [TopeRule] "}" ;
DeclShape.        Decl ::= "shape" Var ":=" Shape ;
DeclCommandProve. Decl ::= "prove" "{" Sequent "}" ;
separator Decl ";" ;

Shape.  Shape ::= "{" PointPattern ":" Cube "|" Tope "}" ;

PointPatternVar.  PointPattern ::= Var ;
PointPatternPair. PointPattern ::= "âŸ¨" PointPattern "," PointPattern "âŸ©" ;

NullaryPointConDecl.  PointConDecl ::= "point" Label ;
PrefixPointConDecl.   PointConDecl ::= "point" Label "(" [Cube] ")" ;
separator PointConDecl ";" ;

CubeProduct.  Cube  ::= Cube "Ã—" Cube1 ;
CubeUnit.     Cube1 ::= "ğŸ™" ;
CubeCon.      Cube1 ::= Label ;
CubeVar.      Cube1 ::= Var ;
coercions Cube 1 ;
separator nonempty Cube "," ;

TopeRule. TopeRule ::= "rule" RuleName "where" "{" [Sequent] Line ";" Sequent "}" ;
separator TopeRule ";" ;

RuleName. RuleName ::= String ;

Sequent. Sequent ::= CubeContext "|" TopeContext "âŠ¢" Tope ;
separator Sequent ";" ;

CubeContextEmpty. CubeContext ::= "â‹…" ;
CubeContextNonEmpty. CubeContext ::= [PointDecl] ;

PointDecl. PointDecl ::= Var ":" Cube ;
separator nonempty PointDecl "," ;

TopeContextEmpty. TopeContext ::= "â‹…" ;
TopeContextNonEmpty. TopeContext ::= [Tope] ;

TopeTop.      Tope  ::= "âŠ¤" ;
TopeBottom.   Tope  ::= "âŠ¥" ;
TopeImplies.  Tope  ::= Tope "â‡’" Tope1 ;
TopeOr.       Tope1 ::= Tope1 "âˆ¨" Tope2 ;
TopeAnd.      Tope2 ::= Tope2 "âˆ§" Tope3 ;
TopeEQ.       Tope3 ::= Point "â‰¡" Point ;
TopeCon.      Tope3 ::= Label "(" [Point] ")" ;
TopeVar.      Tope3 ::= Var ;
coercions Tope 3 ;
separator nonempty Tope "," ;

PointUnit.    Point ::= "â‹†" ;
PointPair.    Point ::= "âŸ¨" Point "," Point "âŸ©" ;
PointFirst.   Point ::= "Ï€â‚" "(" Point ")" ;
PointSecond.  Point ::= "Ï€â‚‚" "(" Point ")" ;
PointCon.     Point ::= Label "(" [Point] ")" ;
nullaryPoint. Point ::= Label ;
PointVar.     Point ::= Var ;
define nullaryPoint con = PointCon con [] ;
separator nonempty Point "," ;
